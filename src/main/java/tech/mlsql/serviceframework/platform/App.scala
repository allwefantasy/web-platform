package tech.mlsql.serviceframework.platform

import java.io.File
import java.net.{URL, URLClassLoader}

/**
 * 31/1/2020 WilliamZhu(allwefantasy@gmail.com)
 */
object App {
  def main(args: Array[String]): Unit = {
    classPath.split(":").foreach { path =>
      loadJarInDriver(path)
    }
    PluginLoader.load(Array(clzz), "tech.mlsql.app_runtime.plugin.PluginDesc")
  }

  val home = "/Users/allwefantasy/ar_plugin_repo"

  def classPath = {
    s".:${home}/.sfcli/cache/app-runtime_2.11-1.0.0.jar:/Users/allwefantasy/.m2/repository/tech/mlsql/serviceframework/baseweb/web-platform_2.11/0.1.2/web-platform_2.11-0.1.2.jar:/Users/allwefantasy/.m2/repository/tech/mlsql/common-utils_2.11/0.2.1/common-utils_2.11-0.2.1.jar:/Users/allwefantasy/.m2/repository/org/python/jython-standalone/2.7.1/jython-standalone-2.7.1.jar:/Users/allwefantasy/.m2/repository/com/lihaoyi/os-lib_2.11/0.2.9/os-lib_2.11-0.2.9.jar:/Users/allwefantasy/.m2/repository/com/lihaoyi/geny_2.11/0.1.6/geny_2.11-0.1.6.jar:/Users/allwefantasy/.m2/repository/org/apache/httpcomponents/fluent-hc/4.5.3/fluent-hc-4.5.3.jar:/Users/allwefantasy/.m2/repository/commons-logging/commons-logging/1.2/commons-logging-1.2.jar:/Users/allwefantasy/.m2/repository/org/apache/httpcomponents/httpclient/4.5.3/httpclient-4.5.3.jar:/Users/allwefantasy/.m2/repository/org/apache/httpcomponents/httpcore/4.4.6/httpcore-4.4.6.jar:/Users/allwefantasy/.m2/repository/commons-codec/commons-codec/1.9/commons-codec-1.9.jar:/Users/allwefantasy/.m2/repository/org/apache/httpcomponents/httpmime/4.5.3/httpmime-4.5.3.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/scala-compiler/2.11.8/scala-compiler-2.11.8.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/scala-reflect/2.11.8/scala-reflect-2.11.8.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/modules/scala-xml_2.11/1.0.4/scala-xml_2.11-1.0.4.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/modules/scala-parser-combinators_2.11/1.0.4/scala-parser-combinators_2.11-1.0.4.jar:/Users/allwefantasy/.m2/repository/org/kamranzafar/jtar/2.2/jtar-2.2.jar:/Users/allwefantasy/.m2/repository/commons-fileupload/commons-fileupload/1.4/commons-fileupload-1.4.jar:/Users/allwefantasy/.m2/repository/commons-io/commons-io/2.2/commons-io-2.2.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/scala-library/2.11.8/scala-library-2.11.8.jar:/Users/allwefantasy/.m2/repository/com/fasterxml/jackson/module/jackson-module-scala_2.11/2.9.8/jackson-module-scala_2.11-2.9.8.jar:/Users/allwefantasy/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.9.8/jackson-core-2.9.8.jar:/Users/allwefantasy/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.9.8/jackson-annotations-2.9.8.jar:/Users/allwefantasy/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.9.8/jackson-databind-2.9.8.jar:/Users/allwefantasy/.m2/repository/com/fasterxml/jackson/module/jackson-module-paranamer/2.9.8/jackson-module-paranamer-2.9.8.jar:/Users/allwefantasy/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/Users/allwefantasy/.m2/repository/org/apache/commons/commons-compress/1.18/commons-compress-1.18.jar:/Users/allwefantasy/.m2/repository/net/liftweb/lift-json_2.11/3.3.0/lift-json_2.11-3.3.0.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/scalap/2.11.11/scalap-2.11.11.jar:/Users/allwefantasy/.m2/repository/com/thoughtworks/paranamer/paranamer/2.8/paranamer-2.8.jar:/Users/allwefantasy/.m2/repository/net/liftweb/lift-json-ext_2.11/3.3.0/lift-json-ext_2.11-3.3.0.jar:/Users/allwefantasy/.m2/repository/net/liftweb/lift-common_2.11/3.3.0/lift-common_2.11-3.3.0.jar:/Users/allwefantasy/.m2/repository/org/slf4j/slf4j-api/1.7.25/slf4j-api-1.7.25.jar:/Users/allwefantasy/.m2/repository/joda-time/joda-time/2.10/joda-time-2.10.jar:/Users/allwefantasy/.m2/repository/org/joda/joda-convert/2.1/joda-convert-2.1.jar:/Users/allwefantasy/.m2/repository/net/csdn/serviceframework-jetty-9-server_2.11/2.0.2/serviceframework-jetty-9-server_2.11-2.0.2.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-server/9.2.16.v20160414/jetty-server-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-continuation/9.2.16.v20160414/jetty-continuation-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-io/9.2.16.v20160414/jetty-io-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-http/9.2.16.v20160414/jetty-http-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-util/9.2.16.v20160414/jetty-util-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-servlet/9.2.16.v20160414/jetty-servlet-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/org/eclipse/jetty/jetty-security/9.2.16.v20160414/jetty-security-9.2.16.v20160414.jar:/Users/allwefantasy/.m2/repository/org/apache/velocity/velocity/1.7/velocity-1.7.jar:/Users/allwefantasy/.m2/repository/commons-collections/commons-collections/3.2.1/commons-collections-3.2.1.jar:/Users/allwefantasy/.m2/repository/commons-lang/commons-lang/2.4/commons-lang-2.4.jar:/Users/allwefantasy/.m2/repository/junit/junit/4.11/junit-4.11.jar:/Users/allwefantasy/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/jline/2.11.0-M3/jline-2.11.0-M3.jar:/Users/allwefantasy/.m2/repository/org/fusesource/jansi/jansi/1.4/jansi-1.4.jar:/Users/allwefantasy/.m2/repository/net/csdn/serviceframework-orm_2.11/2.0.2/serviceframework-orm_2.11-2.0.2.jar:/Users/allwefantasy/.m2/repository/net/csdn/serviceframework-common_2.11/2.0.2/serviceframework-common_2.11-2.0.2.jar:/Users/allwefantasy/.m2/repository/org/yaml/snakeyaml/1.9/snakeyaml-1.9.jar:/Users/allwefantasy/.m2/repository/net/sf/json-lib/json-lib/2.4/json-lib-2.4-jdk15.jar:/Users/allwefantasy/.m2/repository/commons-beanutils/commons-beanutils/1.8.0/commons-beanutils-1.8.0.jar:/Users/allwefantasy/.m2/repository/net/sf/ezmorph/ezmorph/1.0.6/ezmorph-1.0.6.jar:/Users/allwefantasy/.m2/repository/jline/jline/0.9.94/jline-0.9.94.jar:/Users/allwefantasy/.m2/repository/org/javassist/javassist/3.23.1-GA/javassist-3.23.1-GA.jar:/Users/allwefantasy/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/Users/allwefantasy/.m2/repository/org/slf4j/jcl-over-slf4j/1.6.1/jcl-over-slf4j-1.6.1.jar:/Users/allwefantasy/.m2/repository/org/slf4j/slf4j-log4j12/1.6.1/slf4j-log4j12-1.6.1.jar:/Users/allwefantasy/.m2/repository/com/google/guava/guava/15.0/guava-15.0.jar:/Users/allwefantasy/.m2/repository/com/google/inject/guice/3.0/guice-3.0.jar:/Users/allwefantasy/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/Users/allwefantasy/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/Users/allwefantasy/.m2/repository/com/google/inject/extensions/guice-assistedinject/3.0/guice-assistedinject-3.0.jar:/Users/allwefantasy/.m2/repository/com/google/inject/extensions/guice-multibindings/3.0/guice-multibindings-3.0.jar:/Users/allwefantasy/.m2/repository/com/mycila/com/google/inject/guice/3.0-20100927/guice-3.0-20100927.jar:/Users/allwefantasy/.m2/repository/mysql/mysql-connector-java/5.1.6/mysql-connector-java-5.1.6.jar:/Users/allwefantasy/.m2/repository/org/hibernate/hibernate-core/5.3.7.Final/hibernate-core-5.3.7.Final.jar:/Users/allwefantasy/.m2/repository/org/jboss/logging/jboss-logging/3.3.2.Final/jboss-logging-3.3.2.Final.jar:/Users/allwefantasy/.m2/repository/javax/persistence/javax.persistence-api/2.2/javax.persistence-api-2.2.jar:/Users/allwefantasy/.m2/repository/net/bytebuddy/byte-buddy/1.8.17/byte-buddy-1.8.17.jar:/Users/allwefantasy/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/Users/allwefantasy/.m2/repository/org/jboss/spec/javax/transaction/jboss-transaction-api_1.2_spec/1.1.1.Final/jboss-transaction-api_1.2_spec-1.1.1.Final.jar:/Users/allwefantasy/.m2/repository/org/jboss/jandex/2.0.5.Final/jandex-2.0.5.Final.jar:/Users/allwefantasy/.m2/repository/com/fasterxml/classmate/1.3.4/classmate-1.3.4.jar:/Users/allwefantasy/.m2/repository/javax/activation/javax.activation-api/1.2.0/javax.activation-api-1.2.0.jar:/Users/allwefantasy/.m2/repository/org/dom4j/dom4j/2.1.1/dom4j-2.1.1.jar:/Users/allwefantasy/.m2/repository/org/hibernate/common/hibernate-commons-annotations/5.0.4.Final/hibernate-commons-annotations-5.0.4.Final.jar:/Users/allwefantasy/.m2/repository/org/hibernate/hibernate-entitymanager/5.3.7.Final/hibernate-entitymanager-5.3.7.Final.jar:/Users/allwefantasy/.m2/repository/org/hibernate/javax/persistence/hibernate-jpa-2.1-api/1.0.2.Final/hibernate-jpa-2.1-api-1.0.2.Final.jar:/Users/allwefantasy/.m2/repository/com/alibaba/druid/0.2.26/druid-0.2.26.jar:/Users/allwefantasy/.m2/repository/io/getquill/quill-jdbc_2.11/3.4.10/quill-jdbc_2.11-3.4.10.jar:/Users/allwefantasy/.m2/repository/io/getquill/quill-sql_2.11/3.4.10/quill-sql_2.11-3.4.10.jar:/Users/allwefantasy/.m2/repository/io/getquill/quill-core_2.11/3.4.10/quill-core_2.11-3.4.10.jar:/Users/allwefantasy/.m2/repository/com/typesafe/config/1.3.4/config-1.3.4.jar:/Users/allwefantasy/.m2/repository/com/typesafe/scala-logging/scala-logging_2.11/3.9.2/scala-logging_2.11-3.9.2.jar:/Users/allwefantasy/.m2/repository/org/scala-lang/modules/scala-collection-compat_2.11/2.1.2/scala-collection-compat_2.11-2.1.2.jar:/Users/allwefantasy/.m2/repository/com/lihaoyi/pprint_2.11/0.5.4/pprint_2.11-0.5.4.jar:/Users/allwefantasy/.m2/repository/com/lihaoyi/fansi_2.11/0.2.6/fansi_2.11-0.2.6.jar:/Users/allwefantasy/.m2/repository/com/lihaoyi/sourcecode_2.11/0.1.5/sourcecode_2.11-0.1.5.jar:/Users/allwefantasy/.m2/repository/com/zaxxer/HikariCP/3.4.1/HikariCP-3.4.1.jar:/Users/allwefantasy/.m2/repository/commons-pool/commons-pool/1.6/commons-pool-1.6.jar:/Users/allwefantasy/.m2/repository/org/json4s/json4s-jackson_2.11/3.6.1/json4s-jackson_2.11-3.6.1.jar:/Users/allwefantasy/.m2/repository/org/json4s/json4s-core_2.11/3.6.1/json4s-core_2.11-3.6.1.jar:/Users/allwefantasy/.m2/repository/org/json4s/json4s-ast_2.11/3.6.1/json4s-ast_2.11-3.6.1.jar:/Users/allwefantasy/.m2/repository/org/json4s/json4s-scalap_2.11/3.6.1/json4s-scalap_2.11-3.6.1.jar:/Users/allwefantasy/.m2/repository/net/java/dev/jna/jna-platform/5.3.1/jna-platform-5.3.1.jar:/Users/allwefantasy/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/Users/allwefantasy/.m2/repository/net/csdn/serviceframework-web_2.11/2.0.2/serviceframework-web_2.11-2.0.2.jar:/Users/allwefantasy/.m2/repository/org/json4s/json4s-ext_2.11/3.2.11/json4s-ext_2.11-3.2.11.jar:/Users/allwefantasy/.m2/repository/tech/mlsql/serviceframework/baseweb/app_runtime_with_db-lib_2.11/1.0.0/app_runtime_with_db-lib_2.11-1.0.0.jar:/Users/allwefantasy/.m2/repository/tech/mlsql/serviceframework/baseweb/user-system-lib_2.11/1.0.0/user-system-lib_2.11-1.0.0.jar:${home}/ar_plugin_repo-lib/target/classes"
  }

  def clzz = {
    s"${home}/ar_plugin_repo-bin/target/classes"
  }

  def loadJarInDriver(path: String) = {

    val systemClassLoader = ClassLoader.getSystemClassLoader().asInstanceOf[URLClassLoader]
    val method = classOf[URLClassLoader].getDeclaredMethod("addURL", classOf[URL])
    method.setAccessible(true)
    method.invoke(systemClassLoader, new File(path).toURI.toURL)
  }
}


